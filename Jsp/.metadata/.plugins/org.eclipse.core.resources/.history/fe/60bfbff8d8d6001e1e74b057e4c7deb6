<%@page import="guestbook.GuestBookBean"%>
<%@page import="java.util.Vector"%>
<%@ page contentType="text/html; charset=UTF-8"%>
<jsp:useBean id="mgr" class = "guestbook.GuestBookMgr"></jsp:useBean>
<%
	String id = (String)session.getAttribute("idKey");
	if(id == null){
		//현재 접속된 URL 리턴 
		StringBuffer url = request.getRequestURL();
		response.sendRedirect("login.jsp?url="+url);
		return;
	}
%>
<html>
<title>GuestBook</title>
<script type="text/javascript">
	function updateFn(num) {
		url = "updateGuestBook.jsp?num="+num;
		window.open(url, "GuestBook Update", "width=540, height=300");
	}
</script>
<link href="css/style.css" rel="stylesheet" type="text/css">
</head>
<body bgcolor="#996600">
<div align="center">
<%@include file="postGuestBook.jsp" %>
<table width="520" cellspacing="0" cellpadding="3">
	<tr bgcolor="#F5F5F5"> 
		<td><b><%=login.getName()%></b></td>
		<td align="right">로그아웃</b></td>
	</tr>
</table>
<!-- GuestBook List Start -->

<%
	//login 객체는 27라인에 postGuestBook.jsp에서 session에서 가져옴
	Vector<GuestBookBean> vlist = mgr.listGuestBook(id, login.getGrade());
	//out.print(vlist.size());
%>
<%if(vlist.isEmpty()) {%>
<table width="520" cellspacing="0" cellpadding="7">
	<tr>
		<td>등록된 글이 없습니다.</td>
	</tr>
</table>
<%}else{%>
<%
for(int i =0; i<vlist.size();i++){
	//방명록글
	GuestBookBean bean = vlist.get(i);
	//방명록 글쓴이
	JoinBean writer = mgr.getJoin(bean.getId());
	

%>
<%
}//--for
}//--if-else %>

<!-- GuestBook List End -->
<form method="post" name="delFrm">
	<input type="hidden" name="flag" value="delete">
	<input type="hidden" name="cnum">
</form>
</div>
</body>
</html>